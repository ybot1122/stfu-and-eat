---
interface Props {
  src: string;
  alt: string;
}

const { src, alt } = Astro.props;
---

<div class="expandable-image">
  <div class="image-wrapper">
    <img src={src} alt={alt} class="image" />
  </div>
</div>

<style>
  .expandable-image {
    position: relative;
    --thumb-width: 200px;
    margin-top: 1rem;
  }

  .image-wrapper {
    max-width: var(--thumb-width);
    overflow: hidden;
    transition: max-width 360ms ease, transform 360ms ease;
    cursor: pointer;
  }

  .image-wrapper.expanded {
    max-width: 100%;
  }

  .image {
    width: 100%;
    height: auto;
    display: block;
    transition: transform 360ms ease, opacity 200ms ease;
  }

  .toggle-button {
    margin-top: 0.5rem;
    background: transparent;
    border: 1px solid var(--color-foreground, #333);
    padding: 0.35rem 0.6rem;
    border-radius: 6px;
    cursor: pointer;
  }

  .toggle-button[aria-expanded="true"] {
    background: rgba(0,0,0,0.06);
  }
</style>

<script>
  document.querySelectorAll('.expandable-image').forEach((container) => {
    const wrapper = container.querySelector('.image-wrapper')!;
    const img = container.querySelector('.image')!;

    if (!wrapper || !img) return;

    function expand() {
      wrapper.classList.add('expanded');
    }

    function collapse() {
      wrapper.classList.remove('expanded');
    }

    wrapper.addEventListener('click', (e) => {
      e.preventDefault();
      if (wrapper.classList.contains('expanded')) collapse(); else expand();
    });
  });
</script>